<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Vision - ูุธุงู ุฅุฏุงุฑุฉ ุงูุนููุงุก ูุงููุจูุนุงุช</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="../JS/Basic data configuration and management.JS"></script>
    <script src="../JS/Customer and sales management.JS"></script>
    <script src="../JS/Smart Assistant and Additional Functions.JS"></script>
    <link rel="stylesheet" href="../CSS/indx.css">
  
</head>
<body>
    <div class="notification" id="notification"></div>

    <div class="container">
        <div class="header">
            <div style="display: flex; align-items: center; gap: 20px; justify-content: center; margin-bottom: 10px;">
                <img src="../logo.png" alt="Data Vision Logo" style="width: 100px; height: 100px;">
                <h1 style="margin: 0;">Data Vision</h1>
            </div>
            <div class="nav-tabs">
                <button class="tab-btn active" onclick="switchTab('dashboard')">๐ ููุญุฉ ุงูุชุญูู</button>
                <button class="tab-btn" onclick="switchTab('customers')">๐ฅ ุงูุนููุงุก</button>
                <button class="tab-btn" onclick="switchTab('sales')">๐ฐ ุงููุจูุนุงุช</button>
                <button class="tab-btn" onclick="switchTab('whatsapp')">๐ฑ ูุงุชุณุงุจ</button>
                <button class="tab-btn" onclick="switchTab('assistant')">๐ค ุงููุณุงุนุฏ ุงูุฐูู</button>
                <button class="tab-btn" onclick="switchTab('settings')">โ๏ธ ุงูุฅุนุฏุงุฏุงุช</button>
                <button class="btn" onclick="resetActivation()">๐ ุงูุชุฑุฎูุต </button>
            </div>
        </div>

        <div class="content">
            <!-- ูุณู ููุญุฉ ุงูุชุญูู -->
            <div id="dashboard" class="tab-content active">
                <h2 class="page-title-black">ููุญุฉ ุงูุชุญูู</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>ุฅุฌูุงูู ุงูุนููุงุก</h3>
                        <div class="value" id="totalCustomers">0</div>
                    </div>
                    <div class="stat-card success">
                        <h3>ุงูุนููุงุก ุงููุดุทูู</h3>
                        <div class="value" id="activeCustomers">0</div>
                    </div>
                    <div class="stat-card warning">
                        <h3>ุงูุนููุงุก ุบูุฑ ุงููุดุทูู</h3>
                        <div class="value" id="inactiveCustomers">0</div>
                    </div>
                    <div class="stat-card info">
                        <h3>ุฅุฌูุงูู ุงููุจูุนุงุช</h3>
                        <div class="value" id="totalSales">0 ุฏููุงุฑ</div>
                    </div>
                </div>

                <div class="charts-container">
                    <div class="chart-box">
                        <h3>ุชูุฒูุน ุญุงูุฉ ุงูุนููุงุก</h3>
                        <canvas id="statusChart"></canvas>
                    </div>
                    <div class="chart-box">
                        <h3>ูุจูุนุงุช ุขุฎุฑ 7 ุฃูุงู</h3>
                        <canvas id="salesChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- ูุณู ุงูุนููุงุก -->
            <div id="customers" class="tab-content">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 15px;">
                    <h2 class="page-title-black">ุฅุฏุงุฑุฉ ุงูุนููุงุก</h2>
                    <button class="btn btn-primary" onclick="openAddCustomerModal()">โ ุฅุถุงูุฉ ุนููู ุฌุฏูุฏ</button>
                </div>

                <div class="search-box">
                    <input type="text" id="customerSearch" placeholder="๐ ุงุจุญุซ ุนู ุนููู..." onkeyup="filterCustomers()">
                </div>

                <div class="customers-grid" id="customersList">
                    <!-- ุณูุชู ุนุฑุถ ุงูุนููุงุก ููุง -->
                </div>
            </div>

            <!-- ูุณู ุงููุจูุนุงุช -->
            <div id="sales" class="tab-content">
                <h2 class="page-title-black">ุณุฌู ุงููุจูุนุงุช</h2>
                
                <!-- ุฅุถุงูุฉ ุงูููุงุชุฑ -->
                <div style="margin-bottom: 20px;">
                    <label for="startDate">ูู:</label>
                    <input type="date" id="startDate">
                    <label for="endDate">ุฅูู:</label>
                    <input type="date" id="endDate">
                    <button onclick="filterSales()">ุชุตููุฉ ุงููุจูุนุงุช</button>
                </div>

                <!-- ุนุฑุถ ุงููุจูุนุงุช -->
                <div class="sales-list" id="salesList">
                    <!-- ุณูุชู ุนุฑุถ ุงููุจูุนุงุช ููุง -->
                </div>
            </div>

            <!-- ูุณู ูุงุชุณุงุจ -->
            <div id="whatsapp" class="tab-content">
                <h2 class="page-title-black">ุฅุฏุงุฑุฉ ุฑุณุงุฆู ูุงุชุณุงุจ</h2>
                
                <div class="settings-section">
                    <h3>ุฅุฑุณุงู ุฑุณุงูุฉ ุฌูุงุนูุฉ</h3>
                    <div class="form-group">
                        <label>ูุต ุงูุฑุณุงูุฉ</label>
                        <textarea id="bulkMessage" rows="5" placeholder="ูุฑุญุจุงู {name}ุ ูุญู ุณุนุฏุงุก ุจุฎุฏูุชู..."></textarea>
                        <small style="color: #6b7280;">ุงุณุชุฎุฏู {name} ูุฅุฏุฑุงุฌ ุงุณู ุงูุนููู ุชููุงุฆูุงู</small>
                    </div>
                    <button class="btn btn-whatsapp" onclick="sendBulkWhatsApp()">๐ค ุฅุฑุณุงู ููุฌููุน</button>
                </div>

                <div class="settings-section">
                    <h3>ุฑุณุงุฆู ุชููุงุฆูุฉ ููุนููุงุก ุบูุฑ ุงููุดุทูู</h3>
                    <div class="form-group">
                        <label>ูุต ุงูุฑุณุงูุฉ</label>
                        <textarea id="inactiveMessage" rows="4" placeholder="ูุฑุญุจุงู {name}ุ ููุชูุฏู! ูู ุชุญุชุงุฌ ูุณุงุนุฏุฉุ"></textarea>
                    </div>
                    <button class="btn btn-success" onclick="sendToInactive()">๐จ ุฅุฑุณุงู ููุนููุงุก ุบูุฑ ุงููุดุทูู</button>
                </div>
            </div>

            <!-- ูุณู ุงููุณุงุนุฏ ุงูุฐูู -->
            <div id="assistant" class="tab-content">
                <h2 class="page-title-black">ุงููุณุงุนุฏ ุงูุฐูู</h2>
                
                <div class="settings-section">
                    <h3>ูุญุงุฏุซุฉ ูุน ุงููุณุงุนุฏ</h3>
                    <div class="chat-container" id="chatContainer">
                        <div class="chat-message ai-message">
                            <div class="message-avatar">๐ค</div>
                            <div class="message-content">
                                <div class="message-text">ูุฑุญุจุงู! ุฃูุง ุงููุณุงุนุฏ ุงูุฐูู ูู Data Vision. ููู ูููููู ูุณุงุนุฏุชู ุงููููุ ูููููู ุชูุฏูู ุชุญูููุงุช ุญูู ุจูุงูุงุชูุ ุงูุชุฑุงุญุงุช ูุชุญุณูู ุงููุจูุนุงุชุ ููุณุงุนุฏุชู ูู ุฅุฏุงุฑุฉ ุงูุนููุงุก.</div>
                                <div class="message-time" id="messageTime"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="chat-input-container">
                        <div class="quick-actions">
                            <button class="quick-btn" onclick="askAssistant('ุชุญููู ุฃุฏุงุก ุงููุจูุนุงุช')">๐ ุชุญููู ุงููุจูุนุงุช</button>
                            <button class="quick-btn" onclick="askAssistant('ูุตุงุฆุญ ููุนููุงุก ุบูุฑ ุงููุดุทูู')">๐ฅ ูุตุงุฆุญ ููุนููุงุก</button>
                            <button class="quick-btn" onclick="askAssistant('ุงูุชุฑุงุญุงุช ูุชุญุณูู ุงูุฃุฏุงุก')">๐ก ุงูุชุฑุงุญุงุช ุชุญุณูู</button>
                            <button class="quick-btn" onclick="askAssistant('ุชูุฑูุฑ ุดุงูู ุนู ุงูุฃุฏุงุก')">๐ ุชูุฑูุฑ ุดุงูู</button>
                        </div>
                        
                        <div class="form-group" style="margin-top: 15px;">
                            <div style="display: flex; gap: 10px;">
                                <input type="text" id="assistantInput" placeholder="ุงูุชุจ ุณุคุงูู ููุง..." style="flex: 1;" onkeypress="handleKeyPress(event)">
                                <button class="btn btn-primary" onclick="sendMessage()">ุฅุฑุณุงู</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>ุชุญูููุงุช ุฐููุฉ</h3>
                    <div class="ai-insights" id="aiInsights">
                    </div>
                </div>
            </div>

            <!-- ูุณู ุงูุฅุนุฏุงุฏุงุช -->
            <div id="settings" class="tab-content">
                <h2 class="page-title-black">ุงูุฅุนุฏุงุฏุงุช</h2>
                
                <!-- ูุณู ุงุณุชูุฑุงุฏ ูุชุตุฏูุฑ ุงูุจูุงูุงุช -->
                <div class="settings-section">
                    <h3>๐ ุงุณุชูุฑุงุฏ ูุชุตุฏูุฑ ุงูุจูุงูุงุช</h3>
                    <div class="button-group" style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <button onclick="openExportModal()" class="btn btn-primary">๐ค ุชุตุฏูุฑ ุงูุจูุงูุงุช</button>
                        <button onclick="openImportModal()" class="btn btn-secondary">๐ฅ ุงุณุชูุฑุงุฏ ุงูุจูุงูุงุช</button>
                    </div>
                </div>

                <!-- ูุณู ุฅุฏุงุฑุฉ ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ -->
                <div class="settings-section">
                    <h3>๐๏ธ ุฅุฏุงุฑุฉ ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ</h3>
                    <div class="button-group" style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <button class="btn btn-success" onclick="exportData()">๐ ุชุตุฏูุฑ JSON</button>
                        <button class="btn btn-warning" onclick="document.getElementById('importJsonFile').click()">
                            ๐ ุงุณุชูุฑุงุฏ JSON
                        </button>
                        <input type="file" id="importJsonFile" accept=".json" style="display: none;" onchange="importData(event)">
                        <button class="btn btn-danger" onclick="clearAllData()">๐๏ธ ูุณุญ ุฌููุน ุงูุจูุงูุงุช</button>
                    </div>
                </div>

                <!-- ูุณู ูุงูุจ ุงูุฑุณุงุฆู -->
                <div class="settings-section">
                    <h3>โ๏ธ ูุงูุจ ุงูุฑุณุงุฆู ุงูุงูุชุฑุงุถู</h3>
                    <div class="form-group">
                        <label>ุฑุณุงูุฉ ุงูุชุฑุงุถูุฉ</label>
                        <textarea id="defaultMessage" rows="5" placeholder="ูุฑุญุจุงู {name}ุ ุดูุฑุงู ูุงุฎุชูุงุฑู Data Vision!"></textarea>
                    </div>
                    <button class="btn btn-primary" onclick="saveDefaultMessage()">๐พ ุญูุธ ุงููุงูุจ</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ูุงูุฐุฉ ุชุตุฏูุฑ ุงูุจูุงูุงุช -->
    <div id="exportModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>๐ค ุงุฎุชุฑ ุตูุบุฉ ุงูุชุตุฏูุฑ</h3>
                <button class="close-btn" onclick="closeModal('exportModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="export-options" style="display: flex; flex-direction: column; gap: 10px; margin: 20px 0;">
                    <button onclick="exportData()" class="btn btn-primary" style="text-align: right; padding: 15px;">
                        <div style="font-size: 16px; font-weight: bold;">๐ JSON</div>
                        <div style="font-size: 12px; opacity: 0.8;">ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูุงููุฉ ูุน ุฌููุน ุงูุจูุงูุงุช</div>
                    </button>
                    <button onclick="exportToExcel()" class="btn btn-success" style="text-align: right; padding: 15px;">
                        <div style="font-size: 16px; font-weight: bold;">๐ Excel</div>
                        <div style="font-size: 12px; opacity: 0.8;">ููู Excel ูุชุนุฏุฏ ุงูุฃูุฑุงู (ุนููุงุกุ ูุจูุนุงุชุ ุฅุญุตุงุฆูุงุช)</div>
                    </button>
                    <button onclick="exportToCSV()" class="btn btn-info" style="text-align: right; padding: 15px;">
                        <div style="font-size: 16px; font-weight: bold;">๐ CSV</div>
                        <div style="font-size: 12px; opacity: 0.8;">ููู ูุตู ุจุณูุท ููุนููุงุก ูุงููุจูุนุงุช</div>
                    </button>
                </div>
                <button onclick="closeModal('exportModal')" class="btn btn-danger" style="width: 100%;">ุฅูุบุงุก</button>
            </div>
        </div>
    </div>

    <!-- ูุงูุฐุฉ ุงุณุชูุฑุงุฏ ุงูุจูุงูุงุช -->
    <div id="importModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>๐ฅ ุงุฎุชุฑ ุตูุบุฉ ุงูุงุณุชูุฑุงุฏ</h3>
                <button class="close-btn" onclick="closeModal('importModal')">&times;</button>
            </div>
            <div class="modal-body">
                <!-- ูููุงุช ุงูุฅุฏุฎุงู ุงููุฎููุฉ -->
                <input type="file" id="importJson" accept=".json" onchange="importData(event)" style="display: none;">
                <input type="file" id="importExcel" accept=".xlsx,.xls" onchange="importFromExcel(event)" style="display: none;">
                <input type="file" id="importCsv" accept=".csv" onchange="importFromCSV(event)" style="display: none;">
                
                <div class="import-options" style="display: flex; flex-direction: column; gap: 10px; margin: 20px 0;">
                    <button onclick="document.getElementById('importJson').click()" class="btn btn-primary" style="text-align: right; padding: 15px;">
                        <div style="font-size: 16px; font-weight: bold;">๐ JSON</div>
                        <div style="font-size: 12px; opacity: 0.8;">ุงุณุชูุฑุงุฏ ูุณุฎุฉ ุงุญุชูุงุทูุฉ ุณุงุจูุฉ</div>
                    </button>
                    <button onclick="document.getElementById('importExcel').click()" class="btn btn-success" style="text-align: right; padding: 15px;">
                        <div style="font-size: 16px; font-weight: bold;">๐ Excel</div>
                        <div style="font-size: 12px; opacity: 0.8;">ุงุณุชูุฑุงุฏ ูู ููู Excel</div>
                    </button>
                    <button onclick="document.getElementById('importCsv').click()" class="btn btn-info" style="text-align: right; padding: 15px;">
                        <div style="font-size: 16px; font-weight: bold;">๐ CSV</div>
                        <div style="font-size: 12px; opacity: 0.8;">ุงุณุชูุฑุงุฏ ูู ููู CSV</div>
                    </button>
                </div>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 15px 0;">
                    <h4 style="margin: 0 0 10px 0; color: #333;">๐ก ููุงุญุธุฉ ูููุฉ:</h4>
                    <p style="margin: 0; font-size: 14px; color: #666;">
                        ุงูุงุณุชูุฑุงุฏ ุณูููู <strong>ุจุฅุถุงูุฉ</strong> ุงูุจูุงูุงุช ุงูุฌุฏูุฏุฉ ุฅูู ุงูุจูุงูุงุช ุงูุญุงููุฉ. 
                        ูุงุณุชุจุฏุงู ุฌููุน ุงูุจูุงูุงุชุ ูู ุจูุณุญ ุงูุจูุงูุงุช ุฃููุงู ุซู ุงุณุชูุฑุฏ ุงูููู ุงูุฌุฏูุฏ.
                    </p>
                </div>
                <button onclick="closeModal('importModal')" class="btn btn-danger" style="width: 100%;">ุฅูุบุงุก</button>
            </div>
        </div>
    </div>

    <!-- ูุงูุฐุฉ ุฅุถุงูุฉ ุนููู -->
    <div id="customerModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">ุฅุถุงูุฉ ุนููู ุฌุฏูุฏ</h2>
                <button class="close-btn" onclick="closeModal('customerModal')">&times;</button>
            </div>
            <form onsubmit="saveCustomer(event)">
                <div class="form-group">
                    <label>ุงูุงุณู ุงููุงูู *</label>
                    <input type="text" id="customerName" required>
                </div>
                <div class="form-group">
                    <label>ุฑูู ุงููุงุชู (ูุงุชุณุงุจ) *</label>
                    <input type="tel" id="customerPhone" required placeholder="+962XXXXXXXXX">
                </div>
                <div class="form-group">
                    <label>ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
                    <input type="email" id="customerEmail">
                </div>
                <div class="form-group">
                    <label>ุญุงูุฉ ุงูุนููู</label>
                    <select id="customerStatus">
                        <option value="active">ูุดุท</option>
                        <option value="inactive">ุบูุฑ ูุดุท</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>ููุงุญุธุงุช</label>
                    <textarea id="customerNotes" rows="3"></textarea>
                </div>
                <div style="display: flex; gap: 10px;">
                    <button type="submit" class="btn btn-primary">๐พ ุญูุธ</button>
                    <button type="button" class="btn btn-danger" onclick="closeModal('customerModal')">โ ุฅูุบุงุก</button>
                </div>
            </form>
        </div>
    </div>

    <!-- ูุงูุฐุฉ ุฅุถุงูุฉ ุจูุน -->
    <div id="saleModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ุฅุถุงูุฉ ุนูููุฉ ุจูุน</h2>
                <button class="close-btn" onclick="closeModal('saleModal')">&times;</button>
            </div>
            <form onsubmit="saveSale(event)">
                <input type="hidden" id="saleCustomerId">
                <div class="form-group">
                    <label>ุงููุจูุบ (ุฏููุงุฑ) *</label>
                    <input type="number" id="saleAmount" step="0.01" required>
                </div>
                <div class="form-group">
                    <label>ุงูุชุงุฑูุฎ *</label>
                    <input type="date" id="saleDate" required>
                </div>
                <div class="form-group">
                    <label>ุงููุตู</label>
                    <textarea id="saleDescription" rows="3"></textarea>
                </div>
                <div style="display: flex; gap: 10px;">
                    <button type="submit" class="btn btn-success">๐ฐ ุญูุธ</button>
                    <button type="button" class="btn btn-danger" onclick="closeModal('saleModal')">โ ุฅูุบุงุก</button>
                </div>
            </form>
        </div>
    </div>
</body>
</html>